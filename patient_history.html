{% extends "base.html" %}
{% block title %}Patient History{% endblock %}

{% block content %}
<h3 class="mb-3">Patient History</h3>

<div class="mb-3">
  <h5>{{ patient.name }}</h5>
  <p class="text-muted mb-0">{{ patient.email }} | {{ patient.phone }}</p>
</div>

<table class="table table-striped table-sm">
  <thead>
    <tr>
      <th>Date</th>
      <th>Doctor</th>
      <th>Diagnosis</th>
      <th>Prescription</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    {% for a in appointments %}
    <tr>
      <td>{{ a.date }}</td>
      <td>{{ a.doctor.name }}</td>
      <td>{{ a.treatment.diagnosis if a.treatment else '' }}</td>
      <td>{{ a.treatment.prescription if a.treatment else '' }}</td>
      <td>{{ a.treatment.notes if a.treatment else '' }}</td>
    </tr>
    {% else %}
    <tr><td colspan="5" class="text-center">No treatment records</td></tr>
    {% endfor %}
  </tbody>
</table>

{% if user_role == 'patient' %}
<a href="{{ url_for('patient_dashboard') }}" class="btn btn-secondary">Back</a>
{% else %}
<a href="{{ url_for('doctor_dashboard') }}" class="btn btn-secondary">Back</a>
{% endif %}
{% endblock %}
